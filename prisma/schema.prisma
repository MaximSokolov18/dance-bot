datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                 Int           @id @default(autoincrement())
  telegramId         Int           @unique
  firstName          String?
  lastName           String?
  username           String?
  languageCode       String?
  allowNotifications Boolean       @default(true)
  subscriptions      Subscription[]
  createdAt          DateTime      @default(now())
  updatedAt          DateTime      @updatedAt
}

model Subscription {
  id                  Int           @id @default(autoincrement())
  userId              Int
  user                User          @relation(fields: [userId], references: [id])
  groupId             Int
  group               Group         @relation(fields: [groupId], references: [id])
  startDate           DateTime
  paymentDate         DateTime
  typeOfSubscription  SubscriptionType
  amountOfPayment     Float
  typeOfPayment       PaymentType
  illnessCount        Int           @default(0)
  createdAt           DateTime      @default(now())
  updatedAt           DateTime      @updatedAt
}

enum SubscriptionType {
  EightLessons
  FourLessons
  OneLesson
  Trial
}

enum PaymentType {
  Santander
  Cash
  Mono
  Other
}

model Group {
  id            Int            @id @default(autoincrement())
  name          DanceType
  classDays     Weekday[]
  subscriptions Subscription[]
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}

model Holiday {
  id          Int      @id @default(autoincrement())
  name        String
  date        DateTime
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([date])
}

enum Weekday {
  Monday
  Tuesday
  Wednesday
  Thursday
  Friday
  Saturday
  Sunday
}

enum DanceType {
  JazzFunk
  HighHeels
}
